<!doctype html>
<html lang="en">
<head>
	<!-- Required meta tags -->
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.22/css/jquery.dataTables.css">

	<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.js"></script>

	<!-- Primary Meta Tags -->
	<title>Keyword Auto generator</title>
	<meta name="title" content="Keyword Auto generator">
	<meta name="description" content="Editor to write articles which people are searching for on google">

	<!-- Open Graph / Facebook -->
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://www.alicodermaker.com/">
	<meta property="og:title" content="Keyword Auto generator">
	<meta property="og:description" content="Editor to write articles which people are searching for on google">
	<!-- <meta property="og:image" content="https://www.AliCoderMaker.com/images/AliCoderMaker.png"> -->

	<!-- Twitter -->
	<meta property="twitter:card" content="summary_large_image">
	<meta property="twitter:url" content="https://www.alicodermaker.com/">
	<meta property="twitter:title" content="Keyword Auto generator">
	<meta property="twitter:description" content="Editor to write articles which people are searching for on google">
	<!-- <meta property="twitter:image" content="https://www.AliCoderMaker.com/images/AliCoderMaker.png"> -->
	<style>
		.bd-placeholder-img {
			font-size: 1.125rem;
			text-anchor: middle;
			-webkit-user-select: none;
			-moz-user-select: none;
			-ms-user-select: none;
			user-select: none;
		}

		@media (min-width: 768px) {
			.bd-placeholder-img-lg {
				font-size: 3.5rem;
			}
		}
		.header-line{
			text-align: left;
			font-size: 2rem;
			font-weight: 200;
			border-bottom: 0.75px solid currentColor;	
			margin-bottom: 15px;
		}
		.keyword-div{
			/*background-color: yellow;*/
		}

		.keyword-col{
			overflow-y: auto;
			border-right: 20;
			padding: 0px 20px 0px 20px;
			height: 100vh;
		}

		.textarea-col{
			border-right: 20px;
			padding: 0px 20px 0px 20px;
			height: 100vh;

		}

		textarea{
			width: 100%;
			height: 100vh;

		}

		.keyword-div{
			/*background-color: #ededed;*/
			transition: 0.4s, ease;
		}
		.keyword-div:hover {
			background-color: #ededed;
		}

		.keyword-div>p,a {
			margin-top: 2px;
			vertical-align: center;
		}
	</style>

	<!-- Custom styles for this template -->
	<!-- <link href="https://www.AliCoderMaker.com/cover.css" rel="stylesheet"> -->
	<script src="https://AliCoderMaker.com/header.js"></script>

	<!-- TINYMC for text editor -->
	<script src="https://cdn.tiny.cloud/1/kmd7edgycr8jwaicu6cv4l01uj0ybc91n3qk3ookmb67njed/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
	<script>
		tinymce.init({
			selector: '.article-editor',
			placeholder: `Begin by entering a seed keyword and click 'add' for relatable keywords.`
		});
	</script>

</head>
<body>
	<div class="cover-container d-flex p-3 mx-auto flex-column">
		<main role="main" class="inner cover">
			<!-- <h1 class="cover-heading">Copywrite Text Editor</h1> -->
			<!-- <div>
				<div class="row header-line">Enter the keyword</div>
				<div class="custom-form">
					<form id="keyword-form">
						
							<input id="id_keyword" type="text" name="keyword">

							<button class="btn btn-primary" type="submit">Find Longtail</button>
							<div id ="form_errors" style="color: red; font-size: 1rem"></div>
						
					</form>
				</div>
			</div> -->
			<div>
				<!-- <div class="row header-line">Keywords Generated</div> -->
				<div class="row">
					<div class="col-3 keyword-col">
						<div class="row header-line">Keywords</div>

						<div class="row">
							<form id="keyword-form">
								<input id="id_keyword" type="text" name="keyword" value='python vs javascript' placeholder="Enter Seed Keyword">
								<button class="btn btn-primary" type="submit">Find Longtail</button>
								<div id ="form_errors" style="color: red; font-size: 1rem"></div>

							</form>
						</div>
						<div class="row">
							
							<table class="table table-borderless" id="list-of-keywords">
								<thead>
									<tr>
										<th scope="col">rel</th>
										<th scope="col">Keyword</th>
										<th scope="col"></th>
									</tr>
								</thead>
								<tbody id="list-of-keywords-body">
									
								</tbody>
							</table>
						</div>
					</div>
					<div class="col-9 textarea-col">
						<!-- <div class="row header-line">Editor</div> -->

						<textarea id='article-editor' class="article-editor"></textarea>
					</div>
				</div>
			</div>
		</main>
	</div>

	<!-- Optional JavaScript -->
	<!-- jQuery first, then Popper.js, then Bootstrap JS -->
	<!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
	<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

	<!-- trying this text editor for textaread-->
	<script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>

	<!-- The MVP -->
	<script type="text/javascript">
		$(document).ready( function () {
			$('#list-of-keywords').DataTable();
		});

		/*without jQuery (doesn't work in older IEs)*/
		var past_keywords = [];

		// BEGIN KEYWORD GENERATOR SCRIPT
		function startKeywordFinder(event) {

			/*get the keyword from text field*/
			var base_keyword = document.getElementById('id_keyword').value;

			/*check if this keyword have been requested in this before*/
			if (past_keywords.includes(base_keyword)) {
				alert("you have already searched for " + base_keyword);

			} else {
				past_keywords.push(base_keyword);
				const longsearch = false;
				var i;

				// GET ALL ALPHABETS, A TO Z,
				for (var i = 97; i < 123; i++) {
					// SEND IT TO KEYWORD COMBINER
					keyword_combiner(i, base_keyword, longsearch);
				};
				// console.log("Finish");
			};
			// console.log("past_keywords: " + past_keywords)
			// console.log('base_keyword: ' + base_keyword)

			event.preventDefault();
		};

		// CREATE NEW KEYWORD BY ADDING ALPHABET IN FRONT AND END
		function keyword_combiner(i, base_keyword, longsearch) {
			send_api_request(base_keyword + " " + String.fromCharCode(i));
			send_api_request(String.fromCharCode(i) + " " + base_keyword);

			if (longsearch) {
				send_api_request(base_keyword + " " + String.fromCharCode(i) + String.fromCharCode(i));
				send_api_request(String.fromCharCode(i) + String.fromCharCode(i) + " " + base_keyword);
			}
		}

		// SEND API REQUEST
		function send_api_request(keyword) {
			// set the base URL
			let base_url = 'https://suggestqueries.google.com/complete/search?';

			// Start AJAX API Fetch
			$.ajax({
				type: 'GET',
				crossDomain: true,
				dataType: 'jsonp', // we want jsonp. this will over ride CORS stuff
				url: base_url,
				data: {
					'client':'chrome',
					'gl':'in',
					'hl':'en',
					'q' : keyword,
				},
				success: function(jsondata){
					console.log(jsondata)
					
					for (var i = 0; i < jsondata[1].length; i++) {
						// jsondata[1][i]
						let found_keyword_rel = (jsondata[4]['google:suggestrelevance'][i]);
						let found_keyword = (jsondata[1][i]);
						createNewEntry(found_keyword_rel, found_keyword);

					}
					// Add here to catch on fail
				},
			});

		}

		// CREATE NEW TABLE ROW
		function createNewEntry(rel, keyword){
			/*Create a <div> node*/
			var node = document.createElement("tr");
			// node.setAttribute('class','keyword-div col-12');

			// add an innerHTML to the node
			node.innerHTML = `
			<td><p style='color:grey'>${rel}</p></td>
			<td><p style="float: left">${keyword}</p></td>
			<td><a style="float: right" value='${keyword}' onclick="return addH2(this)" href="">Add</a></td>
			`;
			
			/*
			node.innerHTML = `<p style='color:grey'>${rel}</p><p style="float: left">${keyword}</p> 
			<a style="float: right" value='${keyword}' onclick="return addH2(this)" href="">Add</a>`;
			*/

			/* Append this node with the list: id="list-of-keywords" */
			document.getElementById("list-of-keywords-body").appendChild(node);
		}
		// Chekc for form submit. and initiate StartKeywordFinder
		const form = document.getElementById('keyword-form')
		form.addEventListener('submit', startKeywordFinder)


		// Function to add H2 texts in textarea. 
		function addH2(event) {
			var targ = event.getAttribute('value');

			// document.getElementById("article-editor").value += targ;
			
			// tinymce.get('.article-editor').getBody().innerHTML = `<h2>${targ}</h2>`;
			tinymce.editors[0].getBody().innerHTML += `<h2>${targ}</h2>`;

			console.log(targ);
			return false;
		}
		
	</script>
	<!-- END of The MVP -->

</body>
</html>